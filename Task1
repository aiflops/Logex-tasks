Task:1

Create a script that will populate test_patients, test_prices, test_medical_category and test_trajectory_detail tables with random data.

Requirements:

·        test_trajectory_detail: Should be populated by 5 000 000 lines. Activity_id has to be taken from test_activities table and activities should be randomly distributed, each traject must be mapped to at least 3 activities.

·        Traject can contain the same activity multiple times.

·        date_performed for all activities should be randomly distributed 2 years to the past. Date performed for activities within the same traject cannot be more than 3 months apart

·        test_Patients: Should contain data for 300 000 unique patients. For gender use M for male and F for female.

·        test_medical_trajectory: Map trajects to patients at random. Each of the patients must be mapped to at least 1 traject.

#test_prices: generate a random price for each activity. Prices should be in a range from 10 to 200 (use just whole numbers)
ANSWER

declare @countActivities INT = (SELECT count(*) FROM [TASK].[dbo].[test_activities]);
DECLARE @i int=1
while @i <= @countActivities
begin
	declare @price Float = (SELECT ROUND (RAND()*(200-10)+10, 2));
    insert into [TASK].[dbo].[test_prices] (activity_id, price) values (@i,@price);
	set @i+=1
end
UPDATE [TASK].[dbo].[test_prices]
SET price = floor(price)
